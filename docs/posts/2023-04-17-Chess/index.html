<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-04-20">
<meta name="description" content="The Sicilian Defence is the best offense">

<title>Sandro Luis R. Silva - An analysis of the opening moves of the highest-ranked chess players</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/profile.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9FYFKWYLVG"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-9FYFKWYLVG', { 'anonymize_ip': true});
</script>


<meta name="twitter:title" content="Sandro Luis R. Silva - An analysis of the opening moves of the highest-ranked chess players">
<meta name="twitter:description" content="The Sicilian Defence is the best offense">
<meta name="twitter:image" content="thumbnail.jpeg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Sandro Luis R. Silva</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html" rel="" target="">
 <span class="menu-text">Resume</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/slrsilva/slrsilva.github.io" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">An analysis of the opening moves of the highest-ranked chess players</h1>
                  <div>
        <div class="description">
          The Sicilian Defence is the best offense
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">python</div>
                <div class="quarto-category">EDA</div>
                <div class="quarto-category">SQL</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 20, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<!-- <h4>Looks like voting in the Philippines is all about location, location, location! Literacy and religion may not be factors, but hometown pride definitely is.</h4> -->
<p><img src="thumbnail.jpeg" class="img-fluid"></p>
<h1>
Executive Summary
</h1>
<div class="executive-summary">
<p>Original creation and submission for this notebook was last May 29, 2019.</p>
<p>This jupyter notebook was created for my Data Mining and Wrangling class for my Masters in Data Science program in the Asian Institute of Management. In particular, this was done during the 2nd semester for a class - Data Mining and Wrangling - as one of the core requirements. In this report, we shall do an analysis on opening chess moves through exploratory data analysis. In this exercise, we extracted the data from <a href="ChessGames.com">ChessGames.com</a> using the modules <code>Beautifulsoup</code>, <code>requests</code>, and <code>re</code> Python modules, then stored the data in an sqlite database. Results show that the Sicilian, Najdorf (<code>ECO = B90</code>) opening was used in nearly 2.6% of the total games won by the top players. However, looking at the individual players, there is no predominant opening move, with only 7 of the 30 players having the Sicilian, Najdorf move as their top winning opening move.</p>
</div>
<h2 class="anchored">
Acknowledgements
</h2>
<p>This analysis was done together with my Lab partner, George Esleta. I would like to thank Prof Christian Alis and the ACCeSS Laboratory for the access to the high-performance computing facility.</p>
<h2 class="anchored">
A. Introduction and the Problem Statement
</h2>
<p>Chess is a two player strategy game played on a checked 8 by 8 board. The 8 by 8 grid consists of 64 squares where each player is located at opposite ends of the checked board. At the beginning of the game, each player assigned a color of either Black or White. The color scheme indicates which player will move first, with the player with the white pieces moving first. Moves are alternating between players, with each player allowed to only move one chess piece each round.</p>
<p>Each player is given six unique types of pieces with varying numbers, with each unique piece moving differently across the board. Pieces may move to squares occupied by another chess piece. If the player moves into a square occupied by an opponent’s piece, then the opponent’s piece is captured and taken off the chessboard. The purpose of the game is to capture the opponent’s king, signaling a checkmate. Each game is then concluded with either of three scenarios: “1–0” means White won, “0–1” means Black won, and “½–½” indicates a draw (also known as a stalemate).</p>
<p>The first moves in any chess game, also known as a player’s opening move, are the most crucial as it sets the tone, foundation and area of control of the players. The rationale behind this rests on the assumption that the first few moves will influence a player’s probability of winning. The objectives of the opening moves allow each player needs to gain dominance of the grid by: (1) getting most of their pieces out of their default positions as this allows more possible moves), and (2) getting control of the centre of the board (as this allows better dominance).</p>
<p>With the assumption the player’s opening moves may play influential role to the player’s grid control and outcome, the paper will explore the top ranked players opening moves. The purpose of this paper is to determine if there is a specific opening move that each of the top-ranking players use.</p>
<h2 class="anchored">
B. Methodology
</h2>
<h3 class="anchored">
Pre-requisites: Load Requirement Package
</h3>
<p>Before anything else, let us first load all important modules for this exercise.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Loading required modules</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the standard imports</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.plotly <span class="im">as</span> py</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objs <span class="im">as</span> go</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.offline <span class="im">import</span> iplot, init_notebook_mode</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Using plotly + cufflinks in offline mode</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cufflinks</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>cufflinks.go_offline(connected<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>init_notebook_mode(connected<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># This is to allow a code fold in jupyter notebook</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>HTML(<span class="st">'''&lt;script&gt;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="st">  function code_toggle() {</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="st">    if (code_shown){</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="st">      $('div.input').hide('500');</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="st">      $('#toggleButton').val('Show Code')</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">    } else {</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="st">      $('div.input').show('500');</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="st">      $('#toggleButton').val('Hide Code')</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="st">    code_shown = !code_shown</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="st">  $( document ).ready(function(){</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="st">    code_shown=false;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="st">    $('div.input').hide()</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="st">  });</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/script&gt;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;form action="javascript:code_toggle()"&gt;&lt;input type="submit" id="toggleButton" value="Show Code"&gt;&lt;/form&gt;'''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Additionally, we should create a sqlite3 database for where we will store the data what we will scrape. For that, we shall use the <code>sqlite3</code> python module.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Import the SQLite3 moule then create an empty database called chessgames.</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">'chessgames.db'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, since we will be doing some web scraping, which may want to set our proxy and headers. A proxy server can help a scraper avoid IP address blocking, access geographically restricted content, facilitate high-volume scraping, and avoid detection. Headers in web scraping are a part of the HTTP request that provides information about the client making the request. They are important because they can affect the response received from the server. Some websites may block or restrict access to content based on the header information. To avoid being detected as a bot or being blocked by the server, it is important to ensure that the headers used in web scraping are appropriate and mimic those of a real user.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Edit our Proxy and Heading</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting of proxy</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'HTTP_PROXY'</span>] <span class="op">=</span> <span class="st">'http://13.115.147.132:8080'</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'HTTPS_PROXY'</span>] <span class="op">=</span> <span class="st">'http://13.115.147.132:8080'</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting of header</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>header <span class="op">=</span> {<span class="st">'''accept: text/html,application/xhtml+xml,application/xml;q=0.9,</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">            image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">            accept-Encoding: gzip, deflate</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">            accept-Language: en-US,en;q=0.9</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">            cache-Control: max-age=0</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">            connection: keep-alive</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">            host: www.chessgames.com</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">            referer: http://www.chessgames.com/perl/chess.pl?page=16&amp;pid=14125</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">            &amp;playercomp=either&amp;year=2010&amp;yearcomp=ge</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">            upgrade-Insecure-Requests: 1</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">            user-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 </span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">            (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36'''</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<h3 class="anchored">
Step 1: Understand the Data and Conduct Web Scraping Tool
</h3>
<p>To analyze the top opening moves of the highest-rated chess players, web data extraction was performed on the pages of <a href="ChessGames.com">ChessGames.com</a>. We focused on two entities, namely the chess players (<code>players</code>) and their games (<code>games</code>). Data for both entities were saved to an SQLlite database (<code>chessgames.db</code>).</p>
<p>The <code>players</code> table was obtained by scraping all web pages under the Chess Players Directory <a href="http://www.chessgames.com/directory/">http://www.chessgames.com/directory/</a>. Each page in this directory corresponds to a letter of the alphabet (e.g., <a href="http://www.chessgames.com/directory/A">http://www.chessgames.com/directory/A</a>. Each player has the following information:</p>
<center>
Table 1: <code>player</code> table fields
</center>
<table class="table">
<colgroup>
<col style="width: 13%">
<col style="width: 32%">
<col style="width: 42%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Field</th>
<th>Description</th>
<th>Long Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pid</td>
<td>Player ID</td>
<td>indentification number</td>
<td>integer</td>
</tr>
<tr class="even">
<td>lname</td>
<td>Last Name</td>
<td>player’s last name</td>
<td>varchar</td>
</tr>
<tr class="odd">
<td>fname</td>
<td>First Name</td>
<td>player’s first name</td>
<td>varchar</td>
</tr>
<tr class="even">
<td>rating</td>
<td>Rating</td>
<td>highest rating achieved in the database</td>
<td>integer</td>
</tr>
<tr class="odd">
<td>start_year</td>
<td>Start Year</td>
<td>player’s starting year</td>
<td>integer</td>
</tr>
<tr class="even">
<td>end_year</td>
<td>End Year</td>
<td>player’s ending year</td>
<td>integer</td>
</tr>
<tr class="odd">
<td>game_count</td>
<td>Number of games</td>
<td>number of games in database</td>
<td>integer</td>
</tr>
</tbody>
</table>
<p>The <code>get_player_info</code> method was used to scrape the player information (seen below).</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Function description for get_player_info()</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_player_info(url):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Scrapes player info from the specified URL.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameter</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ---------</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">    URL : URL of player page</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Return</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">    ------</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">    list of tuples (pid, lname, fname, rating, start_year, end_year, </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">    game_count)</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    players_list <span class="op">=</span> []</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    resp <span class="op">=</span> requests.get(url, headers<span class="op">=</span>headers)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\t</span><span class="st">Status code: "</span>, resp.status_code)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    resp_soup <span class="op">=</span> BeautifulSoup(resp.text, <span class="st">'lxml'</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    players <span class="op">=</span> resp_soup.select(<span class="st">'tr[bgcolor="#FFFFFF"],tr[bgcolor="#FFEEDD"]'</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> player <span class="kw">in</span> players:</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> player.select(<span class="st">'td'</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        rating <span class="op">=</span> data[<span class="dv">0</span>].text.strip()</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        name <span class="op">=</span> data[<span class="dv">2</span>].text.split(<span class="st">','</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(name) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>            fname <span class="op">=</span> name[<span class="dv">1</span>].strip()</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            fname <span class="op">=</span> <span class="va">None</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        lname <span class="op">=</span> name[<span class="dv">0</span>].strip()</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>        years <span class="op">=</span> data[<span class="dv">3</span>].text.strip()</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        game_count <span class="op">=</span> data[<span class="dv">4</span>].text.strip()</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        start_year <span class="op">=</span> re.match(<span class="st">'(\d</span><span class="sc">{4}</span><span class="st">)?-?(\d</span><span class="sc">{4}</span><span class="st">)'</span>, years).group(<span class="dv">1</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        end_year <span class="op">=</span> re.match(<span class="st">'(\d</span><span class="sc">{4}</span><span class="st">)?-?(\d</span><span class="sc">{4}</span><span class="st">)'</span>, years).group(<span class="dv">2</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        url <span class="op">=</span> <span class="bu">str</span>(player.select(<span class="st">'a'</span>)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>        pid <span class="op">=</span> re.match(<span class="st">'.*?pid=(\d+)'</span>, url).group(<span class="dv">1</span>)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        tup <span class="op">=</span> (pid, lname, fname, rating, start_year, end_year, game_count)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, tup)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        players_list.append(tup)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> players_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For the <code>get_player_info</code> function, the <code>Requests</code> module is a Python library used for making HTTP requests. We can use basic methods such as the <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, and others. The module also provides support for handling cookies, adding custom headers, and handling redirects. We also used the <code>BeautifulSoup</code> Python library, which is a typical package in parsing HTML and XML documents. The package parses the pased HTML source code into a parsed tree, which can be easily traversed. Finally, we used the <code>re</code> Python package to utilize <code>Regular Expression</code> for easier string matching.</p>
<p><br> Next, the players data are then inserted to the <code>players</code> table using the <code>insert_players</code> method:</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Function description for insert_players()</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert_players(conn):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Inserts players into the players table</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameter</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ---------</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">    conn : sqlite connection</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    cur <span class="op">=</span> conn.cursor()</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> string.ascii_uppercase:</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        url <span class="op">=</span> <span class="st">"http://www.chessgames.com/directory/"</span> <span class="op">+</span> char <span class="op">+</span> <span class="st">".html"</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(url)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        players <span class="op">=</span> get_player_info(url)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        cur.executemany(<span class="st">'''INSERT INTO players </span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="st">                            VALUES (?, ?, ?, ?, ?, ?, ?);'''</span>, players)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        conn.commit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here, we access the enter the created database, then Insert the players and associated metadata into the database.</p>
<p><br> Next, this study will focus on the games of the thirty (30) highest-rated players. The ranking was based on the rating provided by the website. To extract the games of these players, we first obtained their player IDs (<code>pid</code>) by using the <code>pandas</code> method <code>read_sql</code>. Here we can pass a <code>SQL</code> statement:</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Method to query the database</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_players <span class="op">=</span> pd.read_sql(<span class="st">"""SELECT pid, fname || ' ' || lname, rating, </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="st">                                    game_count </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="st">                            FROM players</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">                            WHERE rating != ''</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st">                            ORDER BY rating DESC"""</span>, conn)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>df_players.columns <span class="op">=</span> [<span class="st">'Player ID'</span>, <span class="st">'Name'</span>, <span class="st">'Rating'</span>, <span class="st">'Number of Games'</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>df_players.head(<span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="table">
<caption>Table 2: Top 30 chess players based on Rating</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Player ID</th>
<th>Name</th>
<th style="text-align: right;">Rating</th>
<th style="text-align: right;">Number of Games</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">52948</td>
<td>Magnus CARLSEN</td>
<td style="text-align: right;">2882</td>
<td style="text-align: right;">3,016</td>
</tr>
<tr class="even">
<td style="text-align: right;">15940</td>
<td>Garry KASPAROV</td>
<td style="text-align: right;">2851</td>
<td style="text-align: right;">2,385</td>
</tr>
<tr class="odd">
<td style="text-align: right;">76172</td>
<td>Fabiano CARUANA</td>
<td style="text-align: right;">2844</td>
<td style="text-align: right;">1,891</td>
</tr>
<tr class="even">
<td style="text-align: right;">17316</td>
<td>Levon ARONIAN</td>
<td style="text-align: right;">2830</td>
<td style="text-align: right;">2,708</td>
</tr>
<tr class="odd">
<td style="text-align: right;">95915</td>
<td>Wesley SO</td>
<td style="text-align: right;">2822</td>
<td style="text-align: right;">1,400</td>
</tr>
<tr class="even">
<td style="text-align: right;">56798</td>
<td>Maxime VACHIER-LAGRAVE</td>
<td style="text-align: right;">2819</td>
<td style="text-align: right;">2,369</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12088</td>
<td>Viswanathan ANAND</td>
<td style="text-align: right;">2817</td>
<td style="text-align: right;">3,542</td>
</tr>
<tr class="even">
<td style="text-align: right;">12295</td>
<td>Vladimir KRAMNIK</td>
<td style="text-align: right;">2817</td>
<td style="text-align: right;">3,026</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12089</td>
<td>Veselin TOPALOV</td>
<td style="text-align: right;">2816</td>
<td style="text-align: right;">2,278</td>
</tr>
<tr class="even">
<td style="text-align: right;">50065</td>
<td>Shakhriyar MAMEDYAROV</td>
<td style="text-align: right;">2814</td>
<td style="text-align: right;">2,254</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10084</td>
<td>Hikaru NAKAMURA</td>
<td style="text-align: right;">2814</td>
<td style="text-align: right;">2,424</td>
</tr>
<tr class="even">
<td style="text-align: right;">17279</td>
<td>Alexander GRISCHUK</td>
<td style="text-align: right;">2797</td>
<td style="text-align: right;">2,586</td>
</tr>
<tr class="odd">
<td style="text-align: right;">52629</td>
<td>Ding LIREN</td>
<td style="text-align: right;">2797</td>
<td style="text-align: right;">920</td>
</tr>
<tr class="even">
<td style="text-align: right;">107252</td>
<td>Anish GIRI</td>
<td style="text-align: right;">2793</td>
<td style="text-align: right;">1,522</td>
</tr>
<tr class="odd">
<td style="text-align: right;">49796</td>
<td>Teimour RADJABOV</td>
<td style="text-align: right;">2793</td>
<td style="text-align: right;">1,746</td>
</tr>
<tr class="even">
<td style="text-align: right;">54535</td>
<td>Sergey KARJAKIN</td>
<td style="text-align: right;">2788</td>
<td style="text-align: right;">2,399</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11719</td>
<td>Alexander MOROZEVICH</td>
<td style="text-align: right;">2788</td>
<td style="text-align: right;">1,847</td>
</tr>
<tr class="even">
<td style="text-align: right;">12183</td>
<td>Vassily IVANCHUK</td>
<td style="text-align: right;">2787</td>
<td style="text-align: right;">3,752</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19233</td>
<td>Robert James FISCHER</td>
<td style="text-align: right;">2785</td>
<td style="text-align: right;">1,052</td>
</tr>
<tr class="even">
<td style="text-align: right;">20719</td>
<td>Anatoly KARPOV</td>
<td style="text-align: right;">2780</td>
<td style="text-align: right;">3,609</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13847</td>
<td>Boris GELFAND</td>
<td style="text-align: right;">2777</td>
<td style="text-align: right;">3,014</td>
</tr>
<tr class="even">
<td style="text-align: right;">79968</td>
<td>Peter SVIDLER</td>
<td style="text-align: right;">2769</td>
<td style="text-align: right;">2,786</td>
</tr>
<tr class="odd">
<td style="text-align: right;">49080</td>
<td>Leinier Dominguez PEREZ</td>
<td style="text-align: right;">2768</td>
<td style="text-align: right;">1,342</td>
</tr>
<tr class="even">
<td style="text-align: right;">12109</td>
<td>Ruslan PONOMARIOV</td>
<td style="text-align: right;">2768</td>
<td style="text-align: right;">1,989</td>
</tr>
<tr class="odd">
<td style="text-align: right;">54683</td>
<td>Ian NEPOMNIACHTCHI</td>
<td style="text-align: right;">2767</td>
<td style="text-align: right;">1,614</td>
</tr>
<tr class="even">
<td style="text-align: right;">49246</td>
<td>Pentala HARIKRISHNA</td>
<td style="text-align: right;">2766</td>
<td style="text-align: right;">1,442</td>
</tr>
<tr class="odd">
<td style="text-align: right;">49456</td>
<td>Pavel ELJANOV</td>
<td style="text-align: right;">2765</td>
<td style="text-align: right;">1,409</td>
</tr>
<tr class="even">
<td style="text-align: right;">15874</td>
<td>Gata KAMSKY</td>
<td style="text-align: right;">2763</td>
<td style="text-align: right;">1,889</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12290</td>
<td>Peter LEKO</td>
<td style="text-align: right;">2763</td>
<td style="text-align: right;">2,364</td>
</tr>
<tr class="even">
<td style="text-align: right;">112240</td>
<td>Yu YANGYI</td>
<td style="text-align: right;">2762</td>
<td style="text-align: right;">991</td>
</tr>
</tbody>
</table>
<p>The <code>games</code> table was then populated by web scraping <small><code>http://www.chessgames.com/perl/chessplayer?pid=&lt;pid&gt;</code></small> and iterating over the top 30 player IDs. The following fields were extracted for each game:</p>
<table class="table">
<caption>Table 3: <code>games</code> table fields</caption>
<thead>
<tr class="header">
<th>Field</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>gid</td>
<td>Game ID</td>
<td>integer</td>
</tr>
<tr class="even">
<td>white_pid</td>
<td>White Player ID</td>
<td>int</td>
</tr>
<tr class="odd">
<td>black_pid</td>
<td>Black Player ID</td>
<td>int</td>
</tr>
<tr class="even">
<td>result</td>
<td>Result</td>
<td>varchar</td>
</tr>
<tr class="odd">
<td>moves</td>
<td>Number of moves</td>
<td>integer</td>
</tr>
<tr class="even">
<td>year</td>
<td>Year</td>
<td>integer</td>
</tr>
<tr class="odd">
<td>tournament</td>
<td>Tournament Name</td>
<td>varchar</td>
</tr>
<tr class="even">
<td>eco</td>
<td>Encyclopaedia of Chess Openings</td>
<td>varchar</td>
</tr>
<tr class="odd">
<td>opening_move</td>
<td>Opening move</td>
<td>varchar</td>
</tr>
</tbody>
</table>
<p>The <code>get_players_games</code> function was implemented to scrape the game data for a given Player ID <code>pid</code> and page number <code>page_start</code>. This writes the games data of the player to a CSV file (<code>&lt;pid&gt;.csv</code>):</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Function description for the get_players_games()</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_player_games(pid, page_start):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Web scrapes the games list for a player and writes it to a CSV </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">    pid : player ID</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">    page_start : starting page</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">'http://www.chessgames.com/perl/chessplayer?pid='</span> <span class="op">+</span> <span class="bu">str</span>(pid)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    resp <span class="op">=</span> requests.get(url, headers<span class="op">=</span>headers)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'pid = '</span>, pid, <span class="st">'</span><span class="ch">\t</span><span class="st">url = '</span>, url, <span class="st">'</span><span class="ch">\t</span><span class="st">code = '</span>, resp.status_code)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    time.sleep(np.random.randint(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(resp.text, <span class="st">'lxml'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    div_page_count <span class="op">=</span> soup.select(</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'td[background$="/chessimages/table_stripes.gif"]'</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    page_count <span class="op">=</span> <span class="bu">int</span>(re.findall(<span class="st">'of (\d+)\;'</span>, div_page_count[<span class="dv">0</span>].text)[<span class="dv">0</span>])</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="ss">f'</span><span class="sc">{</span>pid<span class="sc">}</span><span class="ss">.csv'</span>, <span class="st">'a'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        csv_writer <span class="op">=</span> csv.writer(<span class="bu">file</span>, delimiter<span class="op">=</span><span class="st">','</span>, quotechar<span class="op">=</span><span class="st">'"'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> page <span class="kw">in</span> <span class="bu">range</span>(page_start, page_count<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>            page_url <span class="op">=</span> <span class="st">'http://www.chessgames.com/perl/chess.pl?page='</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(page) <span class="op">+</span> <span class="st">'&amp;pid='</span> <span class="op">+</span> <span class="bu">str</span>(pid)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>            page_resp <span class="op">=</span> requests.get(page_url, headers<span class="op">=</span>headers)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="ch">\t</span><span class="st">page = '</span>, page, <span class="st">'</span><span class="ch">\t</span><span class="st">url = '</span>, page_url,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'</span><span class="ch">\t</span><span class="st">code = '</span>, page_resp.status_code)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>            time.sleep(np.random.randint(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>            page_soup <span class="op">=</span> BeautifulSoup(page_resp.text, <span class="st">'lxml'</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>            games <span class="op">=</span> page_soup.select(</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">'tr[bgcolor="#FFFFFF"],tr[bgcolor="#EEDDCC"]'</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> game <span class="kw">in</span> games:</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> game.select(<span class="st">'td'</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>                game_url <span class="op">=</span> data[<span class="dv">0</span>].find(<span class="st">"a"</span>)[<span class="st">'href'</span>]</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                game_id <span class="op">=</span> re.findall(<span class="st">'(\d+)'</span>, game_url)[<span class="dv">0</span>]</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> data[<span class="dv">2</span>].text.strip()</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>                moves <span class="op">=</span> data[<span class="dv">3</span>].text.strip()</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>                year <span class="op">=</span> data[<span class="dv">4</span>].text.strip()</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>                tournament <span class="op">=</span> data[<span class="dv">5</span>].text.strip()</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>                eco <span class="op">=</span> data[<span class="dv">6</span>].select(<span class="st">'a'</span>)[<span class="dv">0</span>].text.strip()</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>                opening_move <span class="op">=</span> re.findall(</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'^[A-E0-9][0-9]</span><span class="sc">{2}</span><span class="st"> (.*)'</span>, data[<span class="dv">6</span>].text.strip())[<span class="dv">0</span>]</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>                game_resp <span class="op">=</span> requests.get(</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'http://www.chessgames.com'</span> <span class="op">+</span> game_url, headers<span class="op">=</span>headers)</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>                time.sleep(np.random.randint(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>                game_soup <span class="op">=</span> BeautifulSoup(game_resp.text, <span class="st">'lxml'</span>)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>                players <span class="op">=</span> game_soup.select(<span class="st">'center'</span>)[<span class="dv">0</span>].select(<span class="st">'a'</span>)</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>                    white_id <span class="op">=</span> re.findall(<span class="st">'(\d+)'</span>, players[<span class="dv">0</span>][<span class="st">'href'</span>])[<span class="dv">0</span>]</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>                    white_id <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>                    black_id <span class="op">=</span> re.findall(<span class="st">'(\d+)'</span>, players[<span class="dv">1</span>][<span class="st">'href'</span>])[<span class="dv">0</span>]</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>                    black_id <span class="op">=</span> <span class="va">None</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>                tup <span class="op">=</span> (game_id, white_id, black_id, result,</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>                       moves, year, tournament, eco, opening_move)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                    csv_writer.writerow(tup)</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="ch">\t\t</span><span class="st">gameID: '</span>, game_id, <span class="st">'</span><span class="ch">\t</span><span class="st">Write to CSV failed'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>All player csv files were then inserted to the <code>games</code> table of the <code>chessgames.db</code> database using the <code>read_csvs</code> function:</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Function description for read_csvs()</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_csvs(conn):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Read all player csvs and save them to the games table</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    gid_failed <span class="op">=</span> []</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    cur <span class="op">=</span> conn.cursor()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> file_name <span class="kw">in</span> glob.glob(<span class="st">'./games/*.csv'</span>):</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(file_name) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(file_name)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>            reader <span class="op">=</span> csv.reader(<span class="bu">file</span>, delimiter <span class="op">=</span> <span class="st">','</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> line <span class="kw">in</span> reader:</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                    cur.execute(<span class="st">'''INSERT INTO games VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);'''</span>, line)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="ch">\t\t</span><span class="st">gameID: '</span>, line[<span class="dv">0</span>], <span class="st">'</span><span class="ch">\t</span><span class="st">Insert success!'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                    gid_failed.append(line[<span class="dv">0</span>])</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="ch">\t\t</span><span class="st">gameID: '</span>, line[<span class="dv">0</span>], <span class="st">'</span><span class="ch">\t</span><span class="st">Insert Failed!</span><span class="ch">\t</span><span class="st">'</span>, e)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> gid_failed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, let us examine the games dataframe by calling it with the <code>read_sql</code> Pandas module.</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Accessing the database.</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_games <span class="op">=</span> pd.read_sql(<span class="st">"""SELECT * FROM games"""</span>, conn)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df_games.columns <span class="op">=</span> ([<span class="st">'Game ID'</span>, <span class="st">'White Player ID'</span>, <span class="st">'Black Player ID'</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Result'</span>, <span class="st">'Number of Moves'</span>, <span class="st">'Year'</span>, <span class="st">'Tournament'</span>, <span class="st">'ECO'</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Opening Move'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below you can see that <strong>Table 4</strong> and <strong>Table 5</strong> shows the summary statistics for the <code>players</code> and <code>games</code> table. <strong>8,574 players</strong> and <strong>50,087</strong> games were inserted into the chessgames database.</p>
<table class="table">
<caption>Table 4: <code>players</code> table summary statistics</caption>
<thead>
<tr class="header">
<th>Statistic</th>
<th>Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>count</td>
<td>8574.000000</td>
</tr>
<tr class="even">
<td>mean</td>
<td>2361.279566</td>
</tr>
<tr class="odd">
<td>std</td>
<td>184.344627</td>
</tr>
<tr class="even">
<td>min</td>
<td>1379.000000</td>
</tr>
<tr class="odd">
<td>25%</td>
<td>2268.000000</td>
</tr>
<tr class="even">
<td>50%</td>
<td>2389.000000</td>
</tr>
<tr class="odd">
<td>75%</td>
<td>2479.000000</td>
</tr>
<tr class="even">
<td>max</td>
<td>2882.000000</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Table 5: <code>games</code> table summary statistics</caption>
<thead>
<tr class="header">
<th>Statistic</th>
<th>Number of Moves</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>count</td>
<td>50087.000000</td>
<td>50087.000000</td>
</tr>
<tr class="even">
<td>mean</td>
<td>42.893485</td>
<td>2005.074950</td>
</tr>
<tr class="odd">
<td>std</td>
<td>17.288031</td>
<td>11.643902</td>
</tr>
<tr class="even">
<td>min</td>
<td>0.000000</td>
<td>1953.000000</td>
</tr>
<tr class="odd">
<td>25%</td>
<td>31.000000</td>
<td>2000.000000</td>
</tr>
<tr class="even">
<td>50%</td>
<td>41.000000</td>
<td>2008.000000</td>
</tr>
<tr class="odd">
<td>75%</td>
<td>52.000000</td>
<td>2014.000000</td>
</tr>
<tr class="even">
<td>max</td>
<td>255.000000</td>
<td>2019.000000</td>
</tr>
</tbody>
</table>
<h2 class="anchored">
Results
</h2>
<p><strong>Figure 1</strong> below shows the top 10 opening moves used by the thirty highest-ranked chess players. 356 games, or nearly 2.6% of the games won by the top players, were opened using the Sicilian, Najdorf (ECO = B90) move.</p>
<p>However, looking at the top opening moves per player as seen in <strong>Figure 3</strong>, the Sicilian, Najdorf (ECO = B90) move does not appear as the top move for most of the players. For instance, Magnus Carlsen, the highest-ranked player, has the Ruy Lopez, Berlin Defense as his top opening move. As shown in <strong>Table 7</strong>, Only 7 of the top 30 players have the Sicilian, Najdorf move as their top winning opening move. Also, if we look at the top 5 highest-rated players, 3 of 5 of them have the Ruy Lopez, Berlin Defense move as the top winning move.</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Function to see top 10 opening moves and % won.</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_top_moves <span class="op">=</span> pd.read_sql(<span class="st">"""SELECT g.white_pid, p.fname || ' ' || </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">                            p.lname, p.rating, g.eco, g.opening_move, count(*) </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">                            FROM games g</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">                          INNER JOIN players p on g.white_pid = p.pid</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">                          WHERE g.white_pid IN (SELECT pid FROM players </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                              WHERE rating != ''</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                              ORDER BY rating DESC limit 30)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">                          AND g.result = '1-0'</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">                          GROUP BY g.white_pid, g.eco, g.opening_move</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">                          ORDER BY p.rating DESC, count(*) DESC"""</span>, conn)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>df_top_moves.columns <span class="op">=</span> [<span class="st">'PID'</span>, <span class="st">'Name'</span>, <span class="st">'Rating'</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'ECO'</span>, <span class="st">'Top Opening Move'</span>, <span class="st">'Number of Games Won'</span>]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>df_top_moves <span class="op">=</span> df_top_moves.groupby([<span class="st">'ECO'</span>, <span class="st">'Top Opening Move'</span>])[</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Games Won'</span>].<span class="bu">sum</span>().to_frame()</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>df_top_moves <span class="op">=</span> df_top_moves.sort_values(<span class="st">'Number of Games Won'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>df_top_moves.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>df_top_moves[<span class="st">'</span><span class="sc">% o</span><span class="st">f Games Won'</span>] <span class="op">=</span> (</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    df_top_moves[<span class="st">'Number of Games Won'</span>] <span class="op">/</span> df_top_moves[<span class="st">'Number of Games Won'</span>].<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>df_top_moves.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="table">
<caption>Table 6: Top Opening Moves of the 30 highest-rated players</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 37%">
<col style="width: 29%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>ECO</th>
<th>Top Opening Move</th>
<th>Number of Games Won</th>
<th>% of Games Won</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>B90</td>
<td>Sicilian, Najdorf</td>
<td>356</td>
<td>2.566321</td>
</tr>
<tr class="even">
<td>A07</td>
<td>King’s Indian Attack</td>
<td>250</td>
<td>1.802191</td>
</tr>
<tr class="odd">
<td>B12</td>
<td>Caro-Kann Defense</td>
<td>227</td>
<td>1.63639</td>
</tr>
<tr class="even">
<td>C78</td>
<td>Ruy Lopez</td>
<td>206</td>
<td>1.485006</td>
</tr>
<tr class="odd">
<td>C42</td>
<td>Petrov Defense</td>
<td>205</td>
<td>1.477797</td>
</tr>
<tr class="even">
<td>C11</td>
<td>French</td>
<td>204</td>
<td>1.470588</td>
</tr>
<tr class="odd">
<td>E15</td>
<td>Queen’s Indian</td>
<td>203</td>
<td>1.463379</td>
</tr>
<tr class="even">
<td>A04</td>
<td>Reti Opening</td>
<td>192</td>
<td>1.384083</td>
</tr>
<tr class="odd">
<td>D37</td>
<td>Queen’s Gambit Declined</td>
<td>186</td>
<td>1.34083</td>
</tr>
<tr class="even">
<td>C65</td>
<td>Ruy Lopez, Berlin Defense</td>
<td>176</td>
<td>1.268743</td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="11">
<details>
<summary>Code to generate the Top Opening Moves.</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(dpi<span class="op">=</span><span class="dv">150</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df_top_moves[<span class="dv">10</span>::<span class="op">-</span><span class="dv">1</span>].plot.barh(<span class="st">'Top Opening Move'</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'</span><span class="sc">% o</span><span class="st">f Games Won'</span>, ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'#BF5209'</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                               legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'</span><span class="sc">% o</span><span class="st">f Games Won'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image-outputs/image1-topmoves.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">FIGURE 1:Top Opening Moves of the 30 highest-rated chess players</figcaption><p></p>
</figure>
</div>
<p>Now, let us view the top opening moves per top player (top 10 players)</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code to generate the Top Opening Moves for top players</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_top_moves <span class="op">=</span> pd.read_sql(<span class="st">"""SELECT g.white_pid, p.fname || ' ' || </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="st">                            p.lname, p.rating, g.eco, g.opening_move, count(*) </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="st">                            FROM games g</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="st">                          INNER JOIN players p on g.white_pid = p.pid</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">                          WHERE g.white_pid IN (SELECT pid FROM players </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                              WHERE rating != ''</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                              ORDER BY rating DESC limit 30)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="st">                          AND g.result = '1-0'</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="st">                          GROUP BY g.white_pid, g.eco</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="st">                          ORDER BY p.rating DESC, count(*) DESC"""</span>, conn)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>df_top_moves.columns <span class="op">=</span> [<span class="st">'PID'</span>, <span class="st">'Name'</span>, <span class="st">'Rating'</span>, <span class="st">'ECO'</span>, <span class="st">'Top Opening Move'</span>, <span class="st">'Number of Games Won'</span>]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>df_top_moves <span class="op">=</span> (df_top_moves</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                .groupby([<span class="st">'Rating'</span>, <span class="st">'PID'</span>, <span class="st">'Name'</span>, <span class="st">'ECO'</span>, <span class="st">'Top Opening Move'</span>])</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                [<span class="st">'Number of Games Won'</span>].<span class="bu">sum</span>().to_frame())</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>df_top_moves <span class="op">=</span> (df_top_moves.reset_index()</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                .sort_values([<span class="st">'Rating'</span>, <span class="st">'Number of Games Won'</span>],</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                             ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">False</span>])</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                .set_index([<span class="st">'PID'</span>, <span class="st">'Rating'</span>, <span class="st">'Name'</span>, <span class="st">'ECO'</span>, <span class="st">'Top Opening Move'</span>]))</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>df_top_moves <span class="op">=</span> df_top_moves.groupby(level<span class="op">=</span><span class="dv">0</span>).head(<span class="dv">10</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>df_top_moves.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>df_top_moves</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>names <span class="op">=</span> df_top_moves[<span class="st">'Name'</span>].unique()</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name <span class="kw">in</span> names:</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df_top_moves[df_top_moves[<span class="st">'Name'</span>] <span class="op">==</span> name]</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    df[<span class="dv">10</span>::<span class="op">-</span><span class="dv">1</span>].plot.barh(<span class="st">'Top Opening Move'</span>, <span class="st">'Number of Games Won'</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>                         ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'#BF5209'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    ax.set_title(name)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'Number of Games Won'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-top" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="image-outputs/1-carlsen.png" class="img-fluid figure-img" style="width:100.0%" alt="Magnus Carlsen"> <img src="image-outputs/2-kasparov.png" class="img-fluid figure-img" style="width:100.0%" alt="Garry Kasparov"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="image-outputs/3-caruana.png" class="img-fluid figure-img" style="width:100.0%" alt="Fabiano Caruana"> <img src="image-outputs/4-aronian.png" class="img-fluid figure-img" style="width:100.0%" alt="Levon Aronian"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="image-outputs/5-so.png" class="img-fluid figure-img" style="width:100.0%" alt="Wesley So"> <img src="image-outputs/6-lagrave.png" class="img-fluid figure-img" style="width:100.0%" alt="Maxmime Vachier-Lagrave"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="image-outputs/7-anand.png" class="img-fluid figure-img" style="width:100.0%" alt="Viswanathan Anand"> <img src="image-outputs/8-kramnik.png" class="img-fluid figure-img" style="width:100.0%" alt="Vladimir Kramnik"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="image-outputs/9-topalov.png" class="img-fluid figure-img" style="width:100.0%" alt="Veselin Topalov"> <img src="image-outputs/10-nakamura.png" class="img-fluid figure-img" style="width:100.0%" alt="Hikaru Nakamura"></p>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Top Winning Moves Per Top Player</figcaption><p></p>
</figure>
</div>
<h2 class="anchored">
Conclusions and Recommendations
</h2>
<p>The results indicate that the Sicilian, Najdorf is the most used opening move by the thirty top-ranked players, with 356 games or nearly 2.6% of the games were won using this move. However, looking at the individual opening moves of each top-ranked players, there is no predominant opening move, with only 7 of the 30 players have the Sicilian, Najdorf move as their top winning opening move. Additionally, looking at the top five players, the Ruy Lopez, Berlin Defense was the most frequent opening move.</p>
<p>The methodology of the study does not take into account the total number of games each player competed in. Certain top ranked players have higher number of competition appearances. This may affect the number of instances the Sicilian, Najdorf may appear due to playing style bias. Further research may be conducted to explore normalizing the data by the number of games each top-player appeared in and won. Also, we can explore why the top-ranked players have a preference towards the Ruy Lopez, Berlin Defense.</p>
<h2 class="anchored">
References
</h2>
<i>
<ul>
<li>
<a href="ChessGames.com">ChessGames.com</a>
</li><li>
<a href="https://www.chesscentral.com/pages/learn-chess-play-better/chess-strategy-for-chess-openings-and-chess-principles.html">Chess Strategy for Chess Openings and Chess Principles</a>
</li><li>
<a href="https://www.chessbazaar.com/blog/chess-tournament-rules-regulations-fide-approved/">Chess Tournament Rules Regulations Fide Approved</a>
</li><li>
<a href="https://exeterchessclub.org.uk/content/ten-rules-opening">Ten Rules Openings</a>
</li></ul>
</i><p><i></i></p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>